# Business Understanding

## Название проекта

### **`Персонализированный рекомендательный движок на мультимодальных данных для e-commerce`**

## Организационная структура

Проект выполняется в рамках учебного курса `AI Talent Hub`. Разработка проводится индивидуально.

**Разработчик:** `Тихонов Роман`  
**Менторы и лекторы курса:**

- `Марк Паненко`, Chief Data Scientist в Ozon Fintech
- `Варвара Новожилова`, Head of RnD Skyeng
- `Вадим Чижков`, ex Product Team Lead Everypixel, PM OneCell
- `Андрей Гетманов`, ML Researcher NSS Lab
- `Кристина Желтова`, ML Engineer Газпромбанк
- `Юрий Дмитрин`, Директор центра ИИ Интерсвязь
- `Мария Стенникова`, эксперт по цифровым продуктам и командам

## Бизнес-цель проекта

Создание персонализированного рекомендательного сервиса, способного улучшать пользовательский опыт при покупке товаров за счёт точного предсказания интересных пользователю товаров. Это потенциально повышает выручку и удержание клиентов в e-commerce.

## Существующие решения и их недостатки

Существуют популярные рекомендательные алгоритмы (например, LightFM, ALS, коллаборативная фильтрация), однако они зачастую:

- не используют мультимодальные признаки (тексты, изображения);
- плохо работают при нехватке истории покупок (cold start);
- не масштабируются на задачи со слабой связностью в пользовательском графе.

**Краткий обзор алгоритмов:**

- `LightFM` — гибридный рекомендательный алгоритм, который сочетает коллаборативную фильтрацию и контентные признаки. Поддерживает разные функции потерь и работает с разреженными матрицами.

- `ALS` (Alternating Least Squares) — метод матричной факторизации, который поочерёдно оптимизирует эмбеддинги пользователей и товаров. Хорошо работает с implicit feedback (например, покупки без рейтингов).

- `Коллаборативная фильтрация` — подход, основанный на схожести пользователей или товаров по историческим взаимодействиям. Прост в реализации, но страдает при cold start.

В данном проекте предполагается включение признаков из текста и изображений, а также дальнейшее расширение до графовых методов, что позволит улучшить cold start и повысить качество рекомендаций.

---

## 1.1 Текущая ситуация (Assessing current solution)

### Аппаратные ресурсы

Работа проводится на локальной машине с характеристиками:
- CPU: `Intel(R) Core(TM) i7-10700 @ 2.90GHz`, 8 ядер / 16 потоков;
- RAM: `32 GB` оперативной памяти;
- GPU: `NVIDIA GeForce RTX 2060 SUPER (6 GB VRAM)` + встроенная `Intel UHD Graphics 630`;
- ОС: `Windows 10 Pro, 64-bit`.

Также по необходимости используется `Google Colab` (в т.ч. для работы с тяжелыми эмбеддингами и графовыми вычислениями).

Такой конфигурации достаточно для работы с мультимодальными данными, включая:
- использование LLM и CV-эмбеддингов (через batching / PCA);
- обработку до ~1–2 млн записей одновременно;
- ускоренную тренировку baseline-моделей на табличных фичах и эмбеддингах.

### Источник и хранение данных

Данные открытые и хранятся локально или в облаке:

- `Instacart Market Basket Dataset (Kaggle)` — основа для user-item пар;
- `Open Food Facts (HuggingFace / parquet)` — описания, ингредиенты, категории, изображения;
- `Amazon Product Review Dataset` — текстовые отзывы, рейтинги, метадата.

### Риски проекта

- ❗ Не уложиться в сроки, особенно на этапе слияния данных и генерации эмбеддингов.
- ⚠️ Неудачная маппинг-логика между датасетами.
- ⚠️ Ограничение по объёму данных для моделирования на слабом железе.

Меры:

- начать с подмножеств данных (k-core, parquet, агрегированные сэмплы);
- построить baseline на табличных признаках;
- обеспечить прогресс даже в случае fallback к более простой архитектуре (см. roadmap C → B2 → B1 → A), где:
  - **C** — fallback-вариант: простая бинарная классификация по табличным признакам (user_id, product_id);
  - **B2** — мультимодальная бинарная классификация с добавлением эмбеддингов текста и изображений;
  - **B1** — основной целевой уровень: мультимодальное обучение ранжированию (learning-to-rank) с метриками Hit@k, MAP@k и NDCG@k;
  - **A** — амбассадорский уровень: добавление графовых признаков (например, user-item/item-item графа) и использование GNN для повышения качества рекомендаций, особенно в условиях cold-start или слабосвязных взаимодействий.).

---

## 1.2 Задача в терминах аналитики (Data Mining Goals)

**ML-задача:** бинарная классификация и/или ранжирование пар user-product на основе табличных, текстовых и визуальных признаков.

**Метрики:**

- Основные: `Hit@k`, `MAP@k`, `NDCG@k` (рекомендательные);
- Вспомогательные: `ROC AUC`, `F1`, `Precision@Recall` (для бинарной формулировки);

**Критерии успешности:**

- `ROC AUC > 0.70` для бинарной модели;
- `Hit@10 > 0.35` как baseline для ранжирования.

---

## 1.3 План проекта

Ориентирован на 2 месяца (апрель–июнь), синхронизирован с вебинарами курса:

| Этап                                | Период             | Действия                                                   |
| ----------------------------------- | ------------------ | ---------------------------------------------------------- |
| **Выбор темы и датасетов**          | до 12 апреля       | Финализация задачи, скачивание данных                      |
| **Анализ данных**                   | 13–20 апреля       | EDA, валидация, визуализация, маппинг                      |
| **Формализация ML-задачи**          | 21–28 апреля       | Постановка target, формулировка baseline                   |
| **Feature Engineering**             | 29 апреля – 10 мая | Генерация текстовых/визуальных эмбеддингов, склейка данных |
| **Обучение baseline модели**        | 10–18 мая          | CatBoost/LightFM на табличке + мультимодалка               |
| **Улучшение модели / Ранжирование** | 18–28 мая          | Добавление ранжирования или GNN                            |
| **Сборка MVP (Telegram-бот)**       | 29 мая – 7 июня    | Интеграция предсказаний в интерфейс                        |
| **Подготовка к защите**             | 8–15 июня          | Питч, документация, упаковка                               |

---

✅ Документ отражает текущее понимание бизнес-целей и плана проекта и может уточняться в дальнейшем по ходу реализации.
