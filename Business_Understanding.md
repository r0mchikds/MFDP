# Business Understanding

## Название проекта

### **`Мультимодальная система мэтчинга товаров по изображениям и описаниям на основе CLIP-подобной архитектуры`**

## Организационная структура

Проект выполняется в рамках учебного курса `AI Talent Hub`. Разработка проводится индивидуально.

**Разработчик:** 
`Тихонов Роман`, @tinovokh
**Менторы и лекторы курса:**

- `Марк Паненко`, Chief Data Scientist в Ozon Fintech, @mark_rtb
- `Варвара Новожилова`, Head of RnD Skyeng, @x6750km
- `Вадим Чижков`, ex Product Team Lead Everypixel, PM OneCell
- `Андрей Гетманов`, ML Researcher NSS Lab
- `Кристина Желтова`, ML Engineer Газпромбанк
- `Юрий Дмитрин`, Директор центра ИИ Интерсвязь
- `Мария Стенникова`, эксперт по цифровым продуктам и командам

## Бизнес-цель проекта

Создание мультимодальной системы для рекомендаций в e-commerce, способной сопоставлять товары между собой по смыслу, используя одновременно изображения и описания. Система должна устранять дубли (одинаковые товары с разными названиями, упаковкой и формулировками) и обеспечивать более точные и разнообразные рекомендации. Это особенно важно в условиях, где товар может называться и отображаться по-разному (например, "Сникерс батончик" vs "Snickers с орехами").



В основе — архитектура CLIP или аналогичная, с возможностью дообучения на рекомендательной метрике (`precision@k`).

## Существующие решения и их ограничения

- Большинство рекомендательных систем не объединяют визуальную и текстовую информацию об одном товаре в единое векторное пространство.
- Они не выявляют дубликаты, которые визуально и смыслово одинаковы, но представлены по-разному в базе данных.
- Это приводит к снижению релевантности рекомендаций и ухудшению пользовательского опыта.



**Краткий обзор подхода:**

- Использование CLIP-подобной модели для получения общего эмбеддинга товара (по изображению и описанию);
- Усреднение эмбеддингов товаров, понравившихся пользователю, для получения профиля пользователя;
- Поиск схожих пользователей по эмбеддингам;
- Рекомендация товаров на основе предпочтений схожих пользователей.

Модель можно дообучить на пользовательских взаимодействиях с использованием рекомендательной метрики (`precision@10`) как функции потерь.

---

## 1.1 Текущая ситуация (Assessing current solution)

### Аппаратные ресурсы

Работа проводится на локальной машине с характеристиками:
- CPU: `Intel(R) Core(TM) i7-10700 @ 2.90GHz`, 8 ядер / 16 потоков;
- RAM: `32 GB` оперативной памяти;
- GPU: `NVIDIA GeForce RTX 2060 SUPER (6 GB VRAM)` + встроенная `Intel UHD Graphics 630`;
- ОС: `Windows 10 Pro, 64-bit`.

Также по необходимости используется `Google Colab` (в т.ч. для работы с тяжелыми эмбеддингами).

Такой конфигурации достаточно для работы с мультимодальными данными, включая:
- использование LLM и CV-эмбеддингов (через batching / PCA);
- обработку до ~1–2 млн записей одновременно;
- ускоренную тренировку baseline-моделей на табличных фичах и эмбеддингах.

### Источник и хранение данных

Данные открытые и хранятся локально или в облаке:

- `Instacart Market Basket Dataset (Kaggle)` — возможный источник пользовательских взаимодействий;
- `Open Food Facts (HuggingFace / parquet)` — изображения, текстовые описания, состав и категории продуктов;
- `Amazon Food Review Dataset` — отзывы, рейтинги, изображения и описания продуктов питания.

### Риски проекта



- ❗ Сложность корректного мэтчинга изображений и текстов;
- ⚠️ Разреженность взаимодействий между пользователями и товарами в открытых датасетах;
- ⚠️ Неудачная маппинг-логика при объединении источников данных;
- ⚠️ Риск не успеть реализовать дообучение модели на метрике.

Меры:
- Выбрать сбалансированный датасет с хорошим покрытием изображениями и описаниями;
- Построить pipeline на базе предобученного CLIP;
- Постепенно дообучать модель и замерять влияние на `precision@k`.

---

## 1.2 Задача в терминах аналитики (Data Mining Goals)

**ML-задача:**
- Объединение изображений и описаний товара в общее векторное пространство (эмбеддинг);
- Сопоставление пользователей по их мультимодальным предпочтениям (средние эмбеддинги);
- Рекомендация новых товаров на основе эмбеддингов схожих пользователей.



**Метрики:**
- Основная: `precision@10` (и другие: `@5`, `@20`);
- Дополнительно: `recall@k`, `mean reciprocal rank (MRR)` — по желанию.

**Критерии успешности:**
- `precision@10 > 0.35` для топ-N рекомендаций.

---

## 1.3 План проекта

Ориентирован на 2 месяца (апрель–июнь), синхронизирован с вебинарами курса:

| Этап                                | Период             | Действия                                                   |
| ----------------------------------- | ------------------ | ---------------------------------------------------------- |
| **Уточнение задачи и выбор датасета** | до 12 апреля       | Выбор подходящей пары `изображение + текст`               |
| **Анализ данных**                   | 13–20 апреля       | EDA: изображения, описания, пользовательские связи         |
| **Формализация задачи мэтчинга**    | 21–28 апреля       | Объединение эмбеддингов, формулировка baseline             |
| **Feature Engineering**             | 29 апреля – 10 мая | Экстракция эмбеддингов (CLIP), генерация векторных профилей|
| **Обучение и оценка baseline**      | 10–18 мая          | Рекомендации через схожих пользователей, `precision@k`     |
| **Дообучение модели (по времени)**  | 18–28 мая          | Использование loss по рекомендательной метрике            |
| **Сборка MVP (Swagger или Telegram-бот)** | 29 мая – 7 июня | Интеграция интерфейса, запросы к модели                   |
| **Подготовка к защите**             | 8–15 июня          | Документация, питч, упаковка                              |

---

✅ Документ отражает текущую бизнес-задачу, адаптированную под актуальные методы мультимодальных рекомендаций и реальные бизнес-кейсы. Может уточняться по ходу реализации.
